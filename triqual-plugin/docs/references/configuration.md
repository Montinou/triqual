# Configuration Reference

> **Category:** Configuration | **Updated:** 2026-02-02

Complete reference for `triqual.config.ts` configuration with all options, TypeScript types, and examples.

---

## Overview

Triqual uses a TypeScript configuration file (`triqual.config.ts`) for type safety, IDE autocomplete, and environment variable support.

---

## Basic Configuration

### Minimal Setup

```typescript
import { defineConfig } from 'triqual';

export default defineConfig({
  project_id: 'my-app',
  testDir: './tests',
  baseUrl: 'http://localhost:3000',
});
```

### Generated by /init

Run `/init` to auto-generate configuration based on your project structure:

```bash
/init
```

Creates `triqual.config.ts` with detected settings:
- Finds test directory
- Detects authentication strategy
- Identifies pattern conventions
- Configures MCP servers

---

## Configuration Schema

### Required Fields

| Field | Type | Description |
|-------|------|-------------|
| `project_id` | `string` | Unique project identifier |
| `testDir` | `string` | Test directory path (relative to project root) |
| `baseUrl` | `string` | Application base URL |

### Optional Fields

| Field | Type | Description |
|-------|------|-------------|
| `auth` | `AuthConfig` | Authentication configuration |
| `patterns` | `PatternsConfig` | Test patterns & conventions |
| `mcp` | `McpConfig` | MCP server configuration |

---

## Authentication Configuration

### Strategy: storageState (Recommended)

**Use when:** App supports session storage (cookies, localStorage)

```typescript
export default defineConfig({
  // ... required fields ...

  auth: {
    strategy: 'storageState',
    storageState: {
      path: '.auth/user.json',
    },
  },
});
```

**Setup:**

```bash
# Generate storage state
npx playwright test --headed
# Login manually, close browser
# Storage state saved to .auth/user.json
```

**Usage in tests:**

```typescript
test.use({ storageState: '.auth/user.json' });
```

### Strategy: uiLogin

**Use when:** Need to login via UI for each test

```typescript
export default defineConfig({
  auth: {
    strategy: 'uiLogin',
    credentials: {
      username: process.env.TEST_USERNAME || '',
      password: process.env.TEST_PASSWORD || '',
    },
    loginUrl: '/login',
    selectors: {
      username: 'data-testid=username-input',
      password: 'data-testid=password-input',
      submit: 'data-testid=login-submit',
    },
  },
});
```

**Environment variables:**

```bash
# .env
TEST_USERNAME=test@example.com
TEST_PASSWORD=secure_password
```

### Strategy: setupProject

**Use when:** Complex auth requiring dedicated setup project

```typescript
export default defineConfig({
  auth: {
    strategy: 'setupProject',
    setupScript: './tests/setup/auth.setup.ts',
  },
});
```

**Setup script:**

```typescript
// tests/setup/auth.setup.ts
import { test as setup } from '@playwright/test';

setup('authenticate', async ({ page }) => {
  await page.goto('/login');
  await page.getByTestId('username-input').fill('test@example.com');
  await page.getByTestId('password-input').fill('password');
  await page.getByTestId('login-submit').click();

  await page.context().storageState({ path: '.auth/user.json' });
});
```

**Playwright config:**

```typescript
export default defineConfig({
  projects: [
    { name: 'setup', testMatch: /auth\.setup\.ts/ },
    {
      name: 'chromium',
      use: { storageState: '.auth/user.json' },
      dependencies: ['setup'],
    },
  ],
});
```

### Strategy: none

**Use when:** No authentication required (public pages)

```typescript
export default defineConfig({
  auth: {
    strategy: 'none',
  },
});
```

---

## Patterns Configuration

### Selector Strategy

**data-testid (Recommended):**

```typescript
export default defineConfig({
  patterns: {
    selectors: 'data-testid',
  },
});
```

Generates:

```typescript
await page.getByTestId('login-button').click();
```

**role:**

```typescript
export default defineConfig({
  patterns: {
    selectors: 'role',
  },
});
```

Generates:

```typescript
await page.getByRole('button', { name: 'Login' }).click();
```

**text:**

```typescript
export default defineConfig({
  patterns: {
    selectors: 'text',
  },
});
```

Generates:

```typescript
await page.getByText('Login').click();
```

**css:**

```typescript
export default defineConfig({
  patterns: {
    selectors: 'css',
  },
});
```

Generates:

```typescript
await page.locator('.login-button').click();
```

### Wait Strategy

**networkidle (Recommended for SPAs):**

```typescript
export default defineConfig({
  patterns: {
    waitStrategy: 'networkidle',
  },
});
```

Generates:

```typescript
await page.goto('/dashboard', { waitUntil: 'networkidle' });
```

**domcontentloaded (Faster):**

```typescript
export default defineConfig({
  patterns: {
    waitStrategy: 'domcontentloaded',
  },
});
```

**load:**

```typescript
export default defineConfig({
  patterns: {
    waitStrategy: 'load',
  },
});
```

---

## MCP Configuration

### Enable/Disable MCP Servers

```typescript
export default defineConfig({
  mcp: {
    quoth: {
      enabled: true, // Pattern documentation
    },
    exolar: {
      enabled: true, // Test analytics
      projectId: 'my-app-exolar-id', // Optional
    },
  },
});
```

### Disable All MCP

```typescript
export default defineConfig({
  mcp: {
    quoth: { enabled: false },
    exolar: { enabled: false },
  },
});
```

**Effect:** Triqual works without external pattern/analytics, uses only local knowledge.md

---

## Environment Variables

### Using .env Files

```typescript
import { defineConfig } from 'triqual';
import * as dotenv from 'dotenv';

dotenv.config();

export default defineConfig({
  project_id: process.env.PROJECT_ID || 'default',
  baseUrl: process.env.BASE_URL || 'http://localhost:3000',

  auth: {
    strategy: 'uiLogin',
    credentials: {
      username: process.env.TEST_USERNAME || '',
      password: process.env.TEST_PASSWORD || '',
    },
  },
});
```

**.env:**

```bash
PROJECT_ID=my-app-staging
BASE_URL=https://staging.example.com
TEST_USERNAME=test@example.com
TEST_PASSWORD=secure_password
```

### Per-Environment Configs

```typescript
// triqual.config.ts
import { defineConfig } from 'triqual';

const isDev = process.env.NODE_ENV === 'development';
const isCI = process.env.CI === 'true';

export default defineConfig({
  project_id: 'my-app',
  testDir: './tests',
  baseUrl: isDev
    ? 'http://localhost:3000'
    : isCI
    ? 'https://staging.example.com'
    : 'https://production.example.com',

  auth: {
    strategy: isCI ? 'storageState' : 'uiLogin',
    storageState: isCI ? { path: '.auth/ci-user.json' } : undefined,
  },
});
```

---

## Import External Credentials

### Separate Credentials File

```typescript
// credentials.ts (gitignored)
export const credentials = {
  username: 'test@example.com',
  password: 'secure_password',
};
```

```typescript
// triqual.config.ts
import { defineConfig } from 'triqual';
import { credentials } from './credentials';

export default defineConfig({
  project_id: 'my-app',
  testDir: './tests',
  baseUrl: 'http://localhost:3000',

  auth: {
    strategy: 'uiLogin',
    credentials,
  },
});
```

**.gitignore:**

```gitignore
credentials.ts
.env
.auth/
```

---

## Complete Example

```typescript
// triqual.config.ts
import { defineConfig } from 'triqual';
import * as dotenv from 'dotenv';

dotenv.config();

export default defineConfig({
  // Required
  project_id: process.env.PROJECT_ID || 'my-app',
  testDir: './automation/playwright/tests',
  baseUrl: process.env.BASE_URL || 'http://localhost:3000',

  // Authentication
  auth: {
    strategy: 'storageState',
    storageState: {
      path: '.auth/user.json',
    },
  },

  // Test Patterns
  patterns: {
    selectors: 'data-testid',
    waitStrategy: 'networkidle',
  },

  // MCP Configuration
  mcp: {
    quoth: {
      enabled: true,
    },
    exolar: {
      enabled: true,
      projectId: process.env.EXOLAR_PROJECT_ID,
    },
  },
});
```

---

## TypeScript Types

### Full Type Definitions

```typescript
interface TriqualConfig {
  // Required
  project_id: string;
  testDir: string;
  baseUrl: string;

  // Optional
  auth?: AuthConfig;
  patterns?: PatternsConfig;
  mcp?: McpConfig;
}

interface AuthConfig {
  strategy: 'storageState' | 'uiLogin' | 'setupProject' | 'none';
  storageState?: {
    path: string;
  };
  credentials?: {
    username: string;
    password: string;
  };
  loginUrl?: string;
  selectors?: {
    username: string;
    password: string;
    submit: string;
  };
  setupScript?: string;
}

interface PatternsConfig {
  selectors?: 'data-testid' | 'role' | 'text' | 'css';
  waitStrategy?: 'networkidle' | 'domcontentloaded' | 'load';
}

interface McpConfig {
  quoth?: {
    enabled: boolean;
  };
  exolar?: {
    enabled: boolean;
    projectId?: string;
  };
}
```

### IDE Autocomplete

TypeScript configuration provides IDE autocomplete:

```typescript
import { defineConfig } from 'triqual';

export default defineConfig({
  project_id: 'my-app',
  testDir: './tests',
  baseUrl: 'http://localhost:3000',

  auth: {
    strategy: 'sto  // Autocomplete: storageState | uiLogin | setupProject | none
```

---

## Validation

### Config Validation

Triqual validates configuration on load:

```bash
/init
```

**Valid config:**
```
✅ Configuration valid
```

**Invalid config:**
```
❌ Configuration error: missing required field 'project_id'
```

### Manual Validation

```typescript
// test-config.ts
import config from './triqual.config';

console.log('Config:', config);
console.log('Valid:', config.project_id && config.testDir && config.baseUrl);
```

---

## Related Documentation

- [Installation](/docs/installation) - First-time setup
- [Skills Reference](/docs/skills-reference) - /init command
- [Draft Folder](/docs/draft-folder) - Test organization
- [API Reference](/docs/api-reference) - TypeScript types

---

**Next Steps:** Run `/init` to generate configuration, or read [Installation](/docs/installation) for setup guidance.
